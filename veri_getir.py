import yfinance as yf
import pandas as pd
import json
import os
import datetime

# Verilerin kaydedileceği klasör
DATA_FOLDER = 'USDATAyfinance'
if not os.path.exists(DATA_FOLDER):
    os.makedirs(DATA_FOLDER)

# NASDAQ 100 Listesi (Örnek olarak popüler olanlar, listeyi uzatabilirsin)
tickers = [
    "A","AA","AACAF","AACAY","AAFRF","AAGIY","AAIGF","AAL","AALBF","AANNF","AAON","AAP","AAPG","AAPL","AAUC","AAUKF","AAVMY","AAVXF","AB","ABBNY","ABBV","ABCB","ABEV","ABG","ABLZF","ABM","ABMRF","ABNB","ABT","ABTC","ABVX","ACA","ACAD","ACCYY","ACDSF","ACDVF","ACGBF","ACGBY","ACGL","ACGLN","ACGLO","ACHR","ACI","ACIW","ACKDF","ACLIF","ACLLF","ACLLY","ACLS","ACLTF","ACLX","ACM","ACN","ACOPF","ACOPY","ACRFF","ACSAF","ACSAY","ACT","ACXIF","AD","ADBE","ADC","ADDDF","ADDHY","ADDYY","ADI","ADM","ADMA","ADOOY","ADP","ADPT","ADRNY","ADRZY","ADSK","ADT","ADTTF","ADX","ADYEY","ADYYF","AEE","AEG","AEHR","AEIS","AEM","AEMMF","AEMMY","AEO","AEOXF","AEP","AER","AES","AETUF","AFG","AFGB","AFGC","AFGD","AFGE","AFL","AFLYY","AFRAF","AFRM","AG","AGCO","AGESF","AGESY","AGI","AGIO","AGLNF","AGLXY","AGNC","AGNCL","AGNCM","AGNCN","AGNCO","AGNCP","AGNCZ","AGO","AGPPF","AGRPY","AGX","AGYS","AHCHY","AHEXF","AHEXY","AHICF","AHKSF","AHKSY","AHL","AHODF","AHR","AI","AIAGY","AIBGY","AIBRF","AICAF","AIG","AIIXY","AIPUY","AIQUF","AIQUY","AIR","AIRYY","AIT","AIVAF","AIXXF","AIZ","AIZN","AJG","AJINF","AJINY","AKAM","AKBLF","AKBTY","AKESF","AKO.A","AKO.B","AKR","AKRBF","AKRBY","AKRO","AKZOY","AL","ALAB","ALB","ALBBY","ALBHF","ALBKY","ALC","ALE","ALEGF","ALEUY","ALFRY","ALFVF","ALFVY","ALGM","ALGN","ALH","ALHC","ALIZF","ALIZY","ALK","ALKS","ALKT","ALL","ALLE","ALLY","ALMMF","ALNPY","ALNY","ALPMF","ALPMY","ALRM","ALSMY","ALSN","ALTS","ALV","AM","AMADF","AMADY","AMAT","AMBA","AMBBY","AMBFF","AMBP","AMCCF","AMCR","AMD","AME","AMFPF","AMG","AMGN","AMH","AMIGF","AMIGY","AMKAF","AMKBF","AMKBY","AMKR","AMLTF","AMMNF","AMP","AMR","AMRX","AMRZ","AMT","AMTM","AMX","AMXOF","AMZN","AN","ANCTF","ANET","ANF","ANFGF","ANGPY","ANIOY","ANNSF","ANPDF","ANPDY","ANSLF","ANSLY","ANYYY","ANZGY","AOMFF","AON","AONNF","AONNY","AORT","AOS","AOZOY","APA","APAM","APD","APELY","APEMY","APG","APGE","APH","APLD","APLE","APLS","APNHY","APO","APOS","APP","APPF","APPN","APTV","AQN","AQNB","AR","ARCAY","ARCC","ARCVF","ARE","ARES","ARGNF","ARGTF","ARGX","ARHUF","ARKAF","ARKAY","ARLP","ARLUF","ARM","ARMK","ARMN","ARNNY","AROC","ARQT","ARRPY","ARW","ARWR","ARX","ARXCY","ARZGY","AS","ASAIY","ASAN","ASAZF","ASAZY","ASB","ASBFF","ASBFY","ASBRF","ASCCF","ASCCY","ASEKY","ASGLY","ASH","ASHTF","ASHTY","ASMIY","ASML","ASMLF","ASMOF","ASMVY","ASMXF","ASND","ASO","ASR","ASRMF","ASRRF","ASTS","ASX","ASXFF","ASXFY","ATAT","ATDRF","ATDRY","ATEC","ATEYY","ATGE","ATGFF","ATHM","ATHOF","ATI","ATKR","ATLCY","ATLFF","ATLKY","ATLPF","ATMU","ATO","ATOGF","ATR","ATS","ATZAF","AU","AUB","AUGO","AUKNY","AUOTY","AUPH","AUR","AUTSF","AVA","AVAL","AVAV","AVB","AVDL","AVGO","AVIFY","AVIJF","AVNT","AVPT","AVT","AVTR","AVVIY","AVY","AWATY","AWI","AWK","AWR","AX","AXAHF","AXAHY","AXIA","AXON","AXP","AXS","AXSM","AXTA","AYAAF","AYAAY","AYALY","AYI","AZIHF","AZN","AZNCF","AZO","AZZ","B","BA","BABA","BABAF","BAC","BACHF","BACHY","BAESF","BAESY","BAFBF","BAH","BAIDF","BALDF","BALL","BAM","BAMGF","BAMXF","BANC","BANF","BANR","BAP","BASFY","BATRA","BATRB","BATRK","BAX","BAYRY","BAYZF","BB","BBAI","BBAJF","BBAR","BBD","BBDO","BBIO","BBRYF","BBSEY","BBT","BBU","BBUC","BBVA","BBVXF","BBWI","BBY","BC","BCAUF","BCC","BCCLF","BCDRF","BCE","BCH","BCHMY","BCKIF","BCKIY","BCLYF","BCMXY","BCO","BCPC","BCS","BCUCY","BDC","BDNNY","BDORY","BDOUY","BDRAF","BDRBF","BDRFF","BDRFY","BDRPF","BDULF","BDVSY","BDWBF","BDWBY","BDX","BE","BEAM","BECTY","BEIGF","BEKE","BEN","BEP","BEPC","BESIY","BESVF","BETA","BF.A","BF.B","BFAM","BFFAF","BFH","BFLBY","BG","BGAOF","BGAOY","BGC","BGSI","BGTCF","BHC","BHF","BHFAL","BHFAM","BHFAN","BHFAO","BHFAP","BHKLY","BHP","BHPLF","BICEY","BIDU","BIIB","BILI","BILL","BIO","BIO.B","BIP","BIPC","BIRK","BJ","BJWTF","BK","BKD","BKE","BKEAF","BKEAY","BKFAF","BKFDF","BKFKF","BKFKY","BKGFY","BKH","BKHPF","BKHYY","BKKLY","BKNG","BKNIY","BKQNF","BKQNY","BKR","BKRIF","BKRIY","BKRKF","BKRKY","BKU","BKV","BL","BLBLF","BLCO","BLD","BLDR","BLFBY","BLHEY","BLK","BLKB","BLLN","BLMIF","BLSFF","BLSFY","BLSH","BLTE","BMA","BMBLF","BMBOY","BMCLF","BMDPF","BMI","BMNR","BMO","BMRN","BMRPF","BMRRY","BMWKY","BMXMF","BMY","BMYMP","BN","BNCDY","BNCZF","BNDSF","BNDSY","BNL","BNPQF","BNPQY","BNS","BNT","BNTGF","BNTGY","BNTX","BOH","BOIVF","BOKF","BOLSY","BOOT","BOSSY","BOUYF","BOUYY","BOWFF","BOX","BP","BPAQF","BPCGF","BPCGY","BPHLY","BPIRY","BPOP","BPOPO","BPPPF","BPXXY","BR","BRBOF","BRBR","BRC","BRCTF","BRDCF","BRDCY","BRK.A","BRK.B","BRKR","BRKRP","BRLAF","BRO","BROS","BRRLY","BRSL","BRTHY","BRX","BRZE","BSAC","BSBR","BSDGF","BSDGY","BSM","BSQKZ","BSX","BSY","BTAFF","BTDPF","BTDPY","BTDR","BTE","BTG","BTGOF","BTI","BTLCY","BTSG","BTSGU","BTSNY","BTU","BUD","BUDFF","BULL","BURBY","BURL","BVHMF","BVHMY","BVN","BVNKF","BVNRY","BVRDF","BVVBY","BWA","BWIN","BWXT","BX","BXBLY","BXDIF","BXMT","BXP","BXSL","BYCBF","BYD","BYDDF","BYDDY","BYDIF","BYDIY","BYLOF","BZ","BZLEY","BZLFF","BZLFY","BZLYF","BZQIF","BZQIY","BZZUF","BZZUY","C","CAAP","CABGY","CABJF","CACC","CACI","CADE","CAE","CAG","CAH","CAHPF","CAI","CAIXY","CAJFF","CAJPY","CAKE","CALM","CALX","CAMRF","CAMT","CAOVY","CAPMF","CAR","CARG","CARR","CART","CASY","CAT","CATY","CAVA","CB","CBAUF","CBCY","CBOE","CBRE","CBSH","CBT","CBU","CBUMY","CBZ","CCC","CCDBF","CCEP","CCHBF","CCHGY","CCI","CCJ","CCK","CCL","CCLLF","CCOEY","CCOJY","CCOZF","CCRDF","CCU","CCZ","CDE","CDEFF","CDEVY","CDGLY","CDNAF","CDNS","CDP","CDPYF","CDTX","CDUAF","CDW","CE","CEF","CEG","CELC","CELH","CENX","CEPU","CEVIF","CEVMF","CEVMY","CF","CFACY","CFG","CFLT","CFR","CFRHF","CFRUY","CG","CGAU","CGEMY","CGGGF","CGHLY","CGNMF","CGNX","CGON","CGXYY","CHA","CHBAY","CHCJY","CHD","CHDN","CHDRF","CHDRY","CHE","CHEF","CHEOF","CHEOY","CHFFY","CHFLF","CHGCF","CHGCY","CHH","CHHQY","CHJTF","CHKGF","CHKIF","CHKP","CHLSY","CHRD","CHRW","CHRYY","CHT","CHTR","CHWRF","CHWY","CHYM","CI","CIADF","CIADY","CIB","CIBEY","CICHF","CICHY","CICOF","CICOY","CIEN","CIFR","CIG","CIG.C","CIGI","CIHHF","CIHKY","CIIHY","CILJF","CIMDF","CINF","CITAF","CIVI","CIXPF","CJEWY","CJPRF","CJPRY","CKHGY","CKHUF","CKHUY","CKISY","CL","CLBEY","CLBT","CLCGY","CLCMF","CLF","CLH","CLLNY","CLM","CLNXF","CLPBF","CLPBY","CLPHF","CLPHY","CLPXY","CLS","CLSK","CLVT","CLX","CLZNF","CLZNY","CM","CMA","CMAKY","CMBT","CMC","CMCLF","CMCO","CMCSA","CME","CMG","CMHHF","CMHHY","CMI","CMPGF","CMPGY","CMPO","CMS","CMSA","CMSC","CMSD","CMSQF","CMSQY","CMTOY","CMWAY","CMXHF","CNA","CNALF","CNC","CNGKY","CNH","CNI","CNK","CNM","CNO","CNP","CNQ","CNR","CNS","CNSWF","CNSWY","CNTA","CNVVF","CNVVY","CNX","CNXC","COCO","COCSF","CODGF","CODYY","COF","COGT","COHR","COIHF","COIHY","COIN","COKE","COLB","COLD","COLM","COLZF","COMM","COMP","CON","COO","COP","COR","CORT","CORZ","COST","COTY","COVTY","CP","CPA","CPAMF","CPAY","CPB","CPCAF","CPCAY","CPK","CPNG","CPPCY","CPRI","CPRT","CPRX","CPT","CPXTF","CPXWF","CPYYF","CPYYY","CQP","CR","CRARF","CRARY","CRBD","CRBG","CRBJY","CRC","CRCL","CRDIY","CRDO","CRERF","CRGY","CRH","CRHKY","CRK","CRL","CRM","CRMIF","CRNLF","CRNX","CROMF","CROX","CRRFY","CRRSF","CRS","CRSLF","CRSP","CRUS","CRVL","CRWD","CRWV","CRYCY","CRZBF","CRZBY","CSAN","CSASF","CSCCF","CSCO","CSGEF","CSGP","CSGS","CSL","CSLLY","CSPCY","CSPKF","CSPKY","CSQ","CSTM","CSUAY","CSW","CSX","CSXXY","CTAS","CTATF","CTOUF","CTPCY","CTRA","CTRE","CTRYQ","CTSH","CTTAF","CTTAY","CTTTF","CTVA","CTXAY","CUAEF","CUBB","CUBE","CUBI","CUK","CUKPF","CURB","CUYTY","CUZ","CVBF","CVCO","CVE","CVI","CVLT","CVNA","CVS","CVX","CW","CWAN","CWEN","CWEN.A","CWK","CWQXF","CWSRF","CWST","CWT","CWYUF","CX","CXMSF","CXT","CYAGF","CYATY","CYBR","CYJBY","CYRBY","CYTK","CZMWF","CZMWY","CZR","D","DACHF","DAL","DAN","DANOY","DAR","DASH","DASTF","DASTY","DAVE","DAY","DB","DBD","DBOEF","DBOEY","DBSDF","DBSDY","DBX","DCCPF","DCI","DCNSF","DD","DDOG","DDS","DE","DECK","DELHY","DELKY","DELL","DEO","DEXSF","DFKCY","DFRYF","DFYFF","DG","DGEAF","DGNX","DGX","DHI","DHLGY","DHR","DHT","DIDIY","DIFTY","DINO","DINRF","DIS","DISPF","DITTF","DJT","DK","DKDRF","DKILF","DKILY","DKL","DKNG","DKS","DLAKF","DLAKY","DLB","DLICY","DLKGF","DLMAF","DLMAY","DLO","DLPTF","DLR","DLTR","DLVHF","DNBBF","DNBBY","DNERF","DNFGF","DNFGY","DNGFF","DNKEY","DNLI","DNLMY","DNLZY","DNN","DNNGY","DNOPF","DNOPY","DNOW","DNP","DNPLY","DNPUF","DNTUY","DNZOF","DNZOY","DOC","DOCN","DOCS","DOCU","DOGEF","DOOO","DORM","DOV","DOW","DOX","DPLMF","DPMAY","DPMLF","DPSTF","DPZ","DQ","DQJCF","DQJCY","DRD","DRDGF","DREUF","DRI","DRPRF","DRPRY","DRS","DRVN","DRXGF","DRXGY","DSCSY","DSDVF","DSDVY","DSECF","DSEEY","DSFIY","DSGX","DSKYF","DSMFF","DSNKY","DSRLF","DSVSF","DT","DTB","DTCWY","DTE","DTEGF","DTEGY","DTG","DTGHF","DTK","DTM","DTRUY","DTW","DUAVF","DUFRY","DUK","DUKB","DUOL","DVA","DVCMY","DVDCF","DVN","DWAHY","DWVYF","DXC","DXCM","DY","DYN","E","EA","EADSF","EADSY","EAT","EBAY","EBBGF","EBBNF","EBC","EBCOY","EBGEF","EBKDY","EBKOF","EBRGF","EC","ECG","ECL","ED","EDNMY","EDPFY","EDRVF","EDRWY","EDU","EDVMF","EE","EEFT","EERGF","EFGSY","EFX","EG","EGFEF","EGFEY","EGIEY","EGO","EGP","EHC","EIFZF","EIPAF","EIX","EJPRF","EJPRY","EJTTF","EKIVY","EL","ELALF","ELAN","ELCPF","ELEEF","ELEZY","ELF","ELFIF","ELMUY","ELP","ELPC","ELPQF","ELS","ELV","EMA","EMBJ","EMBVF","EME","EMLAF","EMN","EMR","ENAKF","ENB","ENDTF","ENGGY","ENGIY","ENGQF","ENIC","ENLAY","ENLT","ENPH","ENS","ENSG","ENTG","ENVA","EOG","EOGSF","EONGY","EOSE","EPAM","EPD","EPIAF","EPOAY","EPOBY","EPR","EPRT","EQBBF","EQGPF","EQH","EQIX","EQNR","EQR","EQT","EQUEY","EQX","ERFSF","ERIC","ERIE","ERIXF","ERNXY","ERO","ES","ESAB","ESAIY","ESALF","ESE","ESI","ESLOF","ESLOY","ESLT","ESNT","ESOCF","ESS","ESTC","ESYJY","ET","ETN","ETOR","ETR","ETSY","ETY","EUXTF","EVGGF","EVKIF","EVKIY","EVMNY","EVR","EVRG","EVTL","EVVTY","EW","EWBC","EWTX","EXAS","EXC","EXE","EXEL","EXG","EXK","EXLS","EXP","EXPD","EXPE","EXPGF","EXPGY","EXPO","EXR","EXTR","EXXAF","EXXRF","F","FA","FAF","FANG","FANUF","FANUY","FAST","FBASF","FBBPF","FBIN","FBK","FBNC","FBP","FCBBF","FCFS","FCN","FCNCA","FCNCB","FCNCO","FCNCP","FCODF","FCPT","FCX","FCXXF","FDS","FDX","FE","FELE","FELTY","FER","FERG","FFBC","FFIN","FFIV","FG","FGN","FGSGF","FGSN","FHB","FHI","FHN","FIBK","FICO","FIG","FIGR","FINGF","FINMF","FINMY","FINN","FIS","FISV","FITB","FITBI","FITBO","FITBP","FITGF","FIVE","FIX","FIZZ","FJIKY","FJTCY","FJTNF","FJTNY","FJTSF","FJTSY","FKKFY","FKURF","FLEX","FLG","FLGZY","FLNC","FLO","FLR","FLS","FLUT","FLY","FMCC","FMCCG","FMCCH","FMCCI","FMCCJ","FMCCK","FMCCL","FMCCM","FMCCN","FMCCO","FMCCP","FMCCS","FMCCT","FMCKI","FMCKJ","FMCKK","FMCKL","FMCKM","FMCKN","FMCKO","FMCKP","FMCQF","FMS","FMX","FMXUF","FN","FNB","FNCNF","FNCTF","FND","FNF","FNLPF","FNMA","FNMAG","FNMAH","FNMAI","FNMAJ","FNMAK","FNMAL","FNMAM","FNMAN","FNMAO","FNMAP","FNMAS","FNMAT","FNMFM","FNMFN","FNMFO","FNV","FOJCF","FOJCY","FOLD","FORM","FORTY","FOSUY","FOUR","FOVSY","FOX","FOXA","FPAFF","FPAFY","FPRUY","FQVLF","FR","FRCOF","FRCOY","FREGP","FREJN","FREJO","FREJP","FRFHF","FRFXF","FRHC","FRLOF","FRME","FRMEP","FRMI","FRO","FROG","FRPT","FRSH","FRT","FRTSF","FRZCF","FSK","FSLR","FSM","FSNUF","FSNUY","FSPKF","FSRCY","FSS","FSUGY","FSUMF","FSV","FTAI","FTAIM","FTAIN","FTDR","FTI","FTNT","FTS","FTV","FUJHF","FUJHY","FUJIF","FUJIY","FUL","FULT","FULTP","FUPBY","FUTU","FUWAY","FWONA","FWONK","FYBR","FYGGY","G","GALDY","GALNF","GAP","GARPF","GARPY","GASNY","GATX","GBCI","GBDC","GBERF","GBERY","GBLBF","GBLBY","GBNXF","GBOOF","GBOOY","GBTG","GCHEF","GCMG","GCPEF","GD","GDDY","GDERF","GDS","GDV","GE","GEAGF","GEBHY","GECFF","GEF","GEF.B","GEHC","GELHY","GELYF","GEN","GENI","GEO","GEV","GFF","GFI","GFIOF","GFL","GFS","GGAL","GGB","GGDVY","GGG","GGGSF","GGGSY","GGNDF","GGPSF","GH","GHC","GIB","GIGNF","GIGNY","GIKLY","GIL","GILD","GIS","GJNSY","GKOS","GKTRF","GL","GLAXF","GLBE","GLCNF","GLNCY","GLNG","GLOB","GLPEF","GLPEY","GLPG","GLPI","GLW","GLXY","GM","GMAB","GMBXF","GME","GMED","GMGSF","GMINF","GMOYF","GMVHF","GMVHY","GMWKF","GNENF","GNENY","GNGBY","GNMSF","GNNDY","GNNSF","GNRC","GNTX","GNW","GNZUF","GOF","GOFPY","GOLF","GOOG","GOOGL","GPAEF","GPC","GPCR","GPDNF","GPFOF","GPI","GPK","GPN","GPOR","GRAB","GRAL","GRBK","GRBMF","GRFS","GRGDF","GRMN","GRND","GRNNF","GROUF","GRP.U","GRPTF","GRWLF","GRWTF","GS","GSAT","GSHD","GSISF","GSK","GT","GTES","GTLB","GTLS","GTM","GTOFF","GTX","GULRY","GVA","GVDBF","GVDNY","GWKSY","GWLIF","GWLLF","GWLLY","GWRE","GWW","GXO","GXYEF","GXYYY","GYUAF","GZPZY","H","HACBY","HAE","HAFN","HAGHY","HAL","HALFF","HALMY","HALO","HAS","HASI","HAWPF","HAYW","HBAN","HBANL","HBANM","HBANP","HBCYF","HBI","HBM","HBRIY","HCA","HCC","HCHDF","HCI","HCM","HCMLF","HCMLY","HCXLY","HCXY","HD","HDALF","HDB","HDLMY","HEGIY","HEI","HEI.A","HEINY","HELKF","HENKY","HENOF","HENOY","HESAF","HESAY","HESM","HG","HGKGF","HGKGY","HGTY","HGV","HHH","HHUSF","HI","HICLF","HIG","HII","HIMS","HINKF","HISEF","HIW","HKHGF","HKHHF","HKHHY","HKMPF","HKMPY","HKTGF","HKTTY","HKUOY","HKXCF","HKXCY","HL","HLAGF","HLBBF","HLBZF","HLDCY","HLDVF","HLI","HLLGY","HLMAF","HLN","HLNCF","HLNE","HLPPY","HLT","HLTOY","HLUBF","HMC","HMRZF","HMSNF","HMY","HNDAF","HNGE","HNGKY","HNHPF","HNLGY","HNNMY","HNSDF","HOCFF","HOCPF","HOCPY","HOG","HOKCF","HOKCY","HOLX","HOMB","HON","HOOD","HOYFF","HP","HPCRF","HPE","HPGLY","HPHTF","HPHTY","HPIFY","HPQ","HQY","HR","HRB","HRI","HRL","HRNNF","HROEY","HROW","HRSHF","HRZRF","HSAI","HSBC","HSHCY","HSHZY","HSIC","HSNGY","HSQVY","HST","HSY","HTCMF","HTCMY","HTFL","HTGC","HTHIF","HTHIY","HTHT","HTWSF","HUBB","HUBG","HUBS","HULCF","HUM","HUNGF","HURN","HUT","HVRRF","HVRRY","HWC","HWCPZ","HWDJF","HWKN","HWM","HXGBF","HXGBY","HXL","HXPLF","HYPMY","HYSNF","HYSNY","IAC","IAFNF","IAG","IAUGY","IBDRY","IBDSF","IBIDF","IBIDY","IBKR","IBM","IBN","IBOC","IBP","IBRX","ICAGY","ICE","ICHGF","ICL","ICLR","ICPVF","ICTEF","ICUI","IDA","IDCBF","IDCBY","IDCC","IDEXF","IDEXY","IDKOY","IDXX","IDYA","IEP","IESC","IESFY","IEX","IFCZF","IFF","IFJPY","IFNNF","IFNNY","IFS","IFSUF","IFUUF","IGGHY","IGIFF","IHCPF","IHG","IHICY","IHS","IIJIY","IITSF","IKTSF","IKTSY","ILMN","ILPMY","IMBBF","IMBBY","IMCDY","IMDZF","IMIUY","IMO","IMPUF","IMPUY","IMVT","IMYSY","INCPF","INCY","INDB","INDV","INFA","INFY","ING","INGM","INGR","INOD","INPOF","INPOY","INSM","INSP","INSW","INTA","INTC","INTR","INTU","INVH","IONQ","IONS","IOT","IP","IPAR","IPCFF","IPG","IPGDF","IPGP","IPOAF","IPSEY","IPXHF","IPXHY","IQV","IR","IREN","IRM","IRON","IRT","IRTC","ISDAY","ISMAY","ISNPY","ISRG","ISUZF","ISUZY","IT","ITCFY","ITGGF","ITGR","ITHLF","ITOCF","ITOCY","ITOEF","ITRI","ITT","ITUB","ITVPF","ITVPY","ITW","IVBIY","IVBXF","IVCGF","IVPAF","IVSBF","IVSXF","IVT","IVZ","IWGFF","IX","J","JAIRF","JAPAF","JAPAY","JAPSY","JARLF","JAZZ","JBARF","JBAXY","JBFCF","JBFCY","JBHIF","JBHT","JBL","JBS","JBTM","JCI","JCYGY","JD","JDCMF","JDDSF","JDEPF","JDEPY","JDLGF","JDSPY","JEF","JEXYY","JGCCY","JGSMY","JHG","JHX","JIAXF","JINFF","JKHY","JLL","JMHLY","JMPLY","JMREY","JNJ","JOBY","JOE","JOYY","JPC","JPM","JPPHY","JPSTF","JPSWF","JPSWY","JPTXF","JPXGY","JRONY","JSAIY","JSGRY","JSNSF","JTCPF","JTEKY","JTKWY","JTTRY","JUMSY","JXHGF","JXHLY","JXN","K","KAEPF","KAEPY","KAI","KAJMF","KAJMY","KAKKF","KAOCF","KAOOY","KAR","KB","KBCSY","KBGGY","KBH","KBR","KC","KCDMF","KCDMY","KD","KDDIF","KDDIY","KDP","KEN","KEP","KEX","KEY","KEYS","KEYUF","KFY","KGC","KGDEY","KGFHF","KGFHY","KGHPF","KGS","KGSPF","KGSPY","KGTFF","KGTFY","KGTHY","KHC","KHNGF","KHNGY","KHOLY","KIGRY","KIKOF","KIKOY","KIM","KIROY","KKKUF","KKOYY","KKPNF","KKPNY","KKR","KKRT","KLAC","KLAR","KLBAY","KLPEF","KLYCY","KMB","KMI","KMPB","KMPR","KMTUF","KMTUY","KMX","KNBHF","KNBWY","KNCAY","KNCRY","KNEVF","KNF","KNRRY","KNSA","KNSL","KNTK","KNTNF","KNX","KNYJF","KNYJY","KO","KOBNF","KOF","KOKSF","KONMY","KOTMY","KOYJF","KOZAY","KPCPF","KPCPY","KPDCF","KPELF","KPELY","KPLUF","KPLUY","KPTCY","KR","KRC","KRDXF","KREVF","KRG","KRMN","KRNTY","KRYAF","KRYAY","KRYS","KSHTY","KSPI","KT","KTB","KTOS","KTWIF","KTWIY","KUASF","KUBTY","KURRY","KVUE","KVYO","KWHIF","KWHIY","KWR","KXHCF","KXIAY","KXSCF","KYCCF","KYIV","KYKOF","KYKOY","KYMR","KYN","KYOCF","KYOCY","L","LAD","LAMR","LAUR","LAZ","LB","LBLCF","LBRDA","LBRDB","LBRDK","LBRDP","LBRT","LBTYA","LBTYB","LBTYK","LCID","LCII","LDNXF","LDOS","LDSCY","LDSVF","LEA","LECO","LEGIF","LEGN","LEN","LEN.B","LEU","LEVI","LFCBY","LFST","LFUS","LGDDF","LGFRY","LGGNF","LGGNY","LGN","LGND","LGRDY","LGRVF","LH","LHX","LI","LIF","LIFX","LII","LIMAF","LIN","LINE","LINRF","LITE","LIVN","LKNCY","LKQ","LKREF","LLDTF","LLESY","LLY","LLYVA","LLYVB","LLYVK","LMGIF","LMND","LMT","LNC","LNG","LNNGY","LNSPF","LNT","LNTH","LNVGF","LNVGY","LNWO","LOAR","LOGI","LOPE","LOTMY","LOW","LPGCY","LPL","LPLA","LPX","LQDA","LRCX","LRLCF","LRLCY","LRN","LSCC","LSEGY","LSGOF","LSRCF","LSRCY","LSTR","LTH","LTM","LU","LUGDF","LULU","LUMN","LUNMF","LUV","LVMHF","LVMUY","LVS","LW","LXP","LYB","LYFT","LYG","LYSCF","LYSDY","LYSFF","LYSFY","LYV","LZAGF","LZAGY","LZRFY","M","MA","MAA","MAANF","MAC","MAHLY","MAHMF","MAIN","MAKSF","MAKSY","MALRF","MALRY","MANH","MANU","MAPGF","MAQAF","MAR","MARA","MARUF","MARUY","MAS","MASI","MAT","MATX","MAURY","MAWAF","MAWHY","MBFJF","MBGAF","MBGYY","MBLY","MBRFY","MBSHY","MBUMY","MBVTF","MC","MCARY","MCD","MCHB","MCHOY","MCHP","MCHPP","MCHVF","MCK","MCO","MCQEF","MCRPF","MCSHF","MCY","MDB","MDGL","MDIBY","MDIKF","MDLZ","MDT","MDU","MEDP","MEJHY","MELI","MENS","MEOH","MET","META","MFC","MFG","MFRVF","MGA","MGCLY","MGCOF","MGDDF","MGDDY","MGEE","MGM","MGPUF","MGR","MGRB","MGRC","MGRD","MGRE","MGY","MGYOY","MH","MHGVY","MHK","MHO","MHVIY","MHVYF","MIAX","MICLF","MIDD","MIELF","MIELY","MIESY","MINBY","MIR","MIRM","MITEF","MITEY","MITFF","MITFY","MITSF","MITSY","MITUF","MITUY","MIUFY","MKC","MKC.V","MKGAF","MKKGY","MKL","MKSI","MKTAY","MKTX","MLCO","MLFNF","MLI","MLM","MLSPF","MLYBY","MLYS","MMC","MMM","MMNNF","MMS","MMSI","MMSMY","MMTOF","MMYT","MNDY","MNGPF","MNHVF","MNODF","MNOIY","MNQFF","MNR","MNRIF","MNSO","MNST","MNTHY","MO","MOD","MOG.A","MOG.B","MOH","MONDY","MONOF","MONOY","MONRF","MONRY","MORN","MOS","MP","MPC","MPFRY","MPLX","MPNGF","MPNGY","MPW","MPWR","MQ","MQBKY","MRAAF","MRAAY","MRCY","MRK","MRNA","MRP","MRPLY","MRPRF","MRPZF","MRUS","MRVL","MRX","MS","MSA","MSADF","MSADY","MSBHF","MSCI","MSFT","MSGE","MSGS","MSI","MSLOY","MSM","MSMKF","MSSMY","MSTR","MSUXF","MT","MTB","MTCH","MTCPY","MTD","MTDR","MTG","MTH","MTHRF","MTHRY","MTLHF","MTLHY","MTLPF","MTN","MTNOY","MTPLF","MTPOF","MTPOY","MTRAF","MTRJF","MTRN","MTSFF","MTSFY","MTSI","MTSUY","MTTRY","MTUAF","MTUAY","MTZ","MU","MUFG","MUR","MURGF","MURGY","MURYF","MUSA","MWA","MXGBF","MXUBY","MYRG","MYTAY","MZDAF","MZDAY","MZHOF","MZTI","NABZY","NAD","NAMS","NAPRF","NATKY","NATL","NAVN","NBGIF","NBGRY","NBIS","NBIX","NBNKF","NBTB","NCBDY","NCLH","NCLTF","NCLTY","NCNO","NCSYF","NCTKF","NCTKY","NDAQ","NDBKY","NDCVF","NDEKY","NDGPF","NDGPY","NDRBF","NDSN","NDVLY","NE","NEA","NECPY","NEE","NEM","NEMCL","NEMKY","NESRF","NET","NETTF","NEU","NEXNY","NEXOF","NEXOY","NEXXY","NFG","NFLX","NFPDF","NG","NGCRF","NGD","NGG","NGGTF","NGKIF","NGLOY","NGXXF","NHI","NHKGF","NHOLF","NHPEF","NHYDY","NHYKF","NI","NIABY","NICE","NINOF","NINOY","NIO","NIOIF","NIPNF","NIQ","NISTF","NISUY","NJDCY","NJR","NKE","NLY","NMEHF","NMIH","NMR","NMRK","NMRSF","NNCHF","NNCHY","NNFSF","NNGPF","NNGRY","NNI","NNN","NNNN","NOC","NOG","NOK","NOKBF","NONOF","NOV","NOVT","NOVTU","NOW","NP","NPIFF","NPNYY","NPO","NPPHY","NPPXF","NPSCY","NPSKY","NPSNY","NPTVF","NPXYY","NRDBY","NRDXF","NRG","NRILY","NRKBY","NRSCF","NRXXY","NSA","NSANF","NSANY","NSC","NSIT","NSKFF","NSLYF","NSRGF","NSRGY","NTAP","NTDOF","NTDOY","NTDTY","NTES","NTIOF","NTNX","NTOIF","NTOIY","NTR","NTRA","NTRS","NTRSO","NTSGF","NTSK","NTTYY","NTXVF","NU","NUE","NURAF","NUVL","NUVSF","NVDA","NVG","NVMI","NVO","NVR","NVS","NVSEF","NVST","NVT","NVTS","NVZMF","NVZMY","NWE","NWG","NWOEF","NWS","NWSA","NWSGY","NWSZF","NXE","NXGPY","NXPI","NXPRF","NXSNF","NXST","NXT","NYT","NZF","NZTCF","O","OBDC","OBICY","OBIIF","OBYCF","OC","OCANF","OCDDY","OCLDF","OCLDY","OCPNF","OCUL","ODD","ODFL","OEZVF","OEZVY","OGE","OGFGF","OGFGY","OGN","OGS","OHI","OII","OJIPY","OKE","OKLO","OKTA","OLCLF","OLCLY","OLED","OLGPF","OLLI","OLN","OLYMY","OMAB","OMC","OMF","OMRNY","OMVJF","OMVKY","ON","ONB","ONBPO","ONBPP","ONC","ONDS","ONEXF","ONON","ONTO","OPCH","OPEN","OPHLF","OPHLY","OPMXF","OR","ORA","ORANY","ORCL","ORI","ORINY","ORKLF","ORKLY","ORLA","ORLY","OROVF","OROVY","ORXCF","OS","OSBGF","OSCR","OSCUF","OSGSF","OSGSY","OSIS","OSK","OSSUY","OSW","OTEX","OTF","OTGLF","OTGLY","OTIS","OTPBF","OTSKF","OTSKY","OTTR","OUKPY","OUT","OUTKY","OVCHF","OVCHY","OVV","OWL","OXY","OZK","OZKAP","PAA","PAAS","PAC","PACS","PAEKY","PAFRF","PAFRY","PAG","PAGP","PAGS","PALAF","PAM","PANHF","PANW","PARR","PATH","PATK","PAX","PAY","PAYC","PAYX","PB","PBA","PBCRF","PBCRY","PBF","PBH","PBMRY","PBNAF","PBNNF","PBR","PBR.A","PCAR","PCCWY","PCCYF","PCG","PCH","PCOR","PCRFF","PCRHY","PCTY","PCVX","PCWLF","PDD","PDI","PDRDF","PECO","PEG","PEGA","PEGRY","PEN","PEP","PEXNY","PEYUF","PFE","PFG","PFGC","PFH","PFS","PFSI","PG","PGNY","PGPEF","PGPHF","PGPKY","PGR","PH","PHG","PHI","PHIN","PHJMF","PHLLF","PHM","PHPPY","PHPRF","PHYS","PI","PIAIF","PIFFY","PIFMY","PII","PILBF","PINC","PINS","PINXY","PIPR","PJT","PK","PKG","PKX","PL","PLBL","PLCQF","PLD","PLDGP","PLLIF","PLMR","PLNT","PLTR","PLUG","PLUS","PLXNF","PLXS","PM","PMBPF","PMCUF","PMDIY","PMMAF","PMNXF","PMOIF","PMRTY","PNC","PNDRY","PNFP","PNFPP","PNGAY","PNR","PNW","PNXGF","POAHF","POAHY","PODD","PONY","POOL","POPMF","POR","PORBF","POST","POWL","PPAAY","PPC","PPCCF","PPCCY","PPERY","PPG","PPL","PPLAF","PPRQF","PPRUF","PPRUY","PPTA","PR","PRAX","PRBZF","PRDSF","PRDSY","PREKF","PRH","PRI","PRIM","PRK","PRM","PRMB","PRMRF","PRNDY","PROCF","PROSF","PROSY","PRS","PRU","PRVA","PRYMF","PRYMY","PSA","PSHZF","PSKOF","PSKRF","PSKY","PSLV","PSMMY","PSMT","PSN","PSO","PSORF","PSPSF","PSTG","PSTVY","PSX","PSZKF","PSZKY","PTAIY","PTBRY","PTC","PTCT","PTEN","PTGX","PTITF","PTKFY","PTNDY","PTON","PTRN","PTRRY","PTXKY","PUBGY","PUGBY","PUIGF","PUK","PUKPF","PUMSY","PUODY","PUTKF","PUTKY","PUTRY","PVH","PWCDF","PWR","PWZYF","PYPL","PZAKY","Q","QABSY","QBCRF","QBEIF","QBIEY","QBTS","QCOM","QFIN","QGEN","QIHCF","QLYS","QNTPF","QNTQF","QNTQY","QRNNF","QRVO","QS","QSR","QTWO","QUBSF","QUBT","QXO","R","RACE","RADLY","RAIFY","RAL","RANJF","RANJY","RARE","RBA","RBC","RBGLY","RBGPF","RBLX","RBRK","RBSFY","RBSPF","RBSTF","RCI","RCIAF","RCL","RCRRF","RCRUY","RCUS","RDDT","RDEIY","RDN","RDNT","RDY","REDLD","REG","REGCO","REGCP","REGN","RELX","RELY","REMYF","REMYY","RENZY","REPYF","REPYY","REVG","REXR","REYN","REZI","RF","RGA","RGC","RGEN","RGLD","RGRNF","RGTI","RH","RHHBF","RHHBY","RHHVF","RHI","RHP","RICFY","RICOF","RICOY","RIG","RINIF","RIO","RIOCF","RIOT","RITM","RITPF","RIVN","RJF","RKGRY","RKLB","RKLIF","RKT","RKUNF","RKUNY","RKWBF","RL","RLI","RLLCF","RLLWF","RLX","RLXXF","RMBS","RMD","RMLRF","RMYHY","RNA","RNECF","RNECY","RNG","RNKGF","RNLSY","RNMBF","RNMBY","RNR","RNSHF","RNST","RNW","ROAD","ROHCF","ROHCY","ROIV","ROK","ROKU","ROL","ROP","ROST","ROYMY","RPGRY","RPM","RPRX","RRC","RRR","RRX","RS","RSG","RSHGY","RSI","RSMDF","RSNHF","RTLLF","RTMVF","RTMVY","RTNTF","RTO","RTOXF","RTPPF","RTX","RUBSF","RUM","RUN","RUSHA","RUSHB","RVMD","RVTY","RWEOY","RWNFF","RXEEY","RXLSF","RXRX","RY","RYAAY","RYAN","RYCEF","RYCEY","RYDAF","RYKKY","RYN","RYTM","RZB","RZC","S","SA","SAABF","SAABY","SAFRF","SAFRY","SAH","SAIA","SAIC","SAIL","SALRY","SAM","SAMHF","SAN","SANM","SAP","SAPGF","SAPIF","SAPMF","SAPMY","SARO","SARTF","SASOF","SATLF","SATS","SAUHF","SAUHY","SAXPF","SAXPY","SBAC","SBBTF","SBCF","SBET","SBFFF","SBFFY","SBGOF","SBGSF","SBGSY","SBHGF","SBLK","SBMFF","SBRA","SBS","SBSNY","SBSW","SBUX","SBYSF","SCABY","SCAFF","SCBFF","SCBFY","SCBGF","SCCO","SCCTY","SCGLF","SCGLY","SCGPY","SCHW","SCHYF","SCHYY","SCI","SCMWY","SCOTF","SCRPF","SCRYY","SCTBF","SCTBY","SDCVF","SDIPF","SDMHF","SDVKF","SDVKY","SDXAY","SDXOF","SDZNY","SDZXF","SE","SEB","SECCF","SECYF","SEDG","SEE","SEGXF","SEI","SEIC","SEKEY","SEMHF","SEOAY","SEPJF","SEYMF","SF","SFB","SFBQF","SFBS","SFD","SFFLY","SFGRF","SFGYY","SFHOY","SFM","SFNC","SFRRF","SFSHF","SFTBF","SFTBY","SGAMY","SGAPY","SGBAF","SGBLY","SGGEF","SGGKF","SGGKY","SGHC","SGHDY","SGHHF","SGHIY","SGI","SGIOF","SGIOY","SGPYY","SGSOF","SGSOY","SHAK","SHALY","SHBBF","SHC","SHCAF","SHCAY","SHECF","SHECY","SHEL","SHG","SHLAF","SHLRF","SHMDF","SHMZF","SHNWF","SHOO","SHOP","SHTDY","SHTLF","SHW","SHWDY","SHWGY","SHZHY","SID","SIEGY","SIELY","SIETY","SIG","SIGCY","SIGGF","SIGI","SIGIP","SII","SIM","SIMO","SINGF","SINGY","SIRI","SITE","SITIF","SITIY","SITM","SIXGF","SJM","SKBSY","SKE","SKFOF","SKFRY","SKHCF","SKHHY","SKHSF","SKHSY","SKLTY","SKM","SKSBF","SKSUY","SKT","SKUFF","SKY","SKYT","SKYW","SLAB","SLB","SLDE","SLF","SLFIF","SLFPF","SLFPY","SLG","SLGN","SLLDY","SLM","SLMBP","SLNO","SLVYY","SM","SMAWF","SMBMF","SMBMY","SMCAY","SMCI","SMECF","SMEGF","SMFG","SMFNF","SMG","SMGBF","SMGKF","SMGZY","SMMNY","SMMT","SMMYY","SMNEY","SMNNY","SMNR","SMORF","SMPNY","SMR","SMSEY","SMSOF","SMTC","SMTOF","SMTOY","SN","SNA","SNAP","SNCAF","SNDK","SNDR","SNEJF","SNEX","SNGNF","SNLAY","SNMCY","SNMRY","SNMYF","SNN","SNNRF","SNNUF","SNOW","SNPHY","SNPMF","SNPS","SNPTF","SNRBY","SNROF","SNTMF","SNV","SNX","SNY","SNYNF","SNYYF","SO","SOAGY","SOBKY","SOBO","SOCNF","SOFI","SOHVY","SOJC","SOJD","SOJE","SOJF","SOLS","SOLV","SOMLF","SOMLY","SOMMY","SOMN","SON","SONVF","SONVY","SONY","SOOBF","SOTGY","SOUHY","SOUN","SPASF","SPCE","SPG","SPGI","SPHR","SPHXF","SPIIY","SPKKY","SPNS","SPNT","SPOT","SPPSY","SPR","SPSC","SPTJF","SPXC","SPXCF","SPXCY","SPXSF","SPXSY","SQM","SQNNY","SQNXF","SR","SRAD","SRBEF","SRE","SREA","SRGHY","SRRK","SRTOY","SRTTY","SRUUF","SSAAY","SSB","SSD","SSDOY","SSEZF","SSEZY","SSL","SSLZY","SSMXF","SSMXY","SSNC","SSNLF","SSREF","SSREY","SSRGF","SSRM","SSSAF","SSUMF","SSUMY","ST","STAG","STBBF","STBFY","STC","STE","STEP","STGPF","STHRF","STJPF","STKAF","STLA","STLD","STLJF","STM","STMEF","STMNF","STMZF","STN","STNE","STNG","STOHF","STOSF","STRC","STRD","STRF","STRK","STRL","STRNY","STT","STUB","STVN","STWD","STX","STZ","SU","SUBCY","SUEZY","SUHJY","SUI","SULZF","SUMCF","SUN","SUNC","SUOPY","SUPN","SURRY","SURYY","SUTNY","SUVPF","SUZ","SVCBF","SVKEF","SVNDF","SVNDY","SVNLF","SVNLY","SVTRF","SVYSF","SW","SWDBF","SWDBY","SWGAF","SWGAY","SWGNF","SWK","SWKS","SWOBY","SWONF","SWPFF","SWRAY","SWRBY","SWSDF","SWX","SWZCF","SXI","SXT","SXYAY","SYF","SYIEF","SYIEY","SYK","SYM","SYNA","SYY","SZGPF","SZGPY","SZKMF","SZKMY","SZLMY","T","TAC","TAGOF","TAK","TAL","TAP","TAP.A","TARS","TATYF","TATYY","TAVHY","TAWNF","TBB","TBBB","TBBK","TBCCF","TBVPF","TBVPY","TCBI","TCBIO","TCCPY","TCEHY","TCENF","TCHBF","TCKRF","TCLHF","TCMEF","TCMFF","TCOM","TCTZF","TD","TDC","TDG","TDHOF","TDHOY","TDS","TDW","TDY","TEAM","TECH","TECK","TEF","TEFOF","TEL","TELNF","TELNY","TEM","TENB","TEO","TER","TERN","TEVA","TEVJF","TEX","TEZNY","TFC","TFII","TFPM","TFSL","TFX","TGLS","TGNA","TGOPF","TGOPY","TGS","TGT","TGTX","THC","THDDY","THG","THKLY","THLEF","THLLY","THNPY","THO","THUPY","THYCY","TIAIY","TIAOF","TIC","TIGO","TIIAY","TIMB","TISCY","TISNF","TJX","TKAMY","TKC","TKECF","TKECY","TKGBY","TKGSY","TKHVY","TKKHF","TKMSF","TKO","TKOMF","TKOMY","TKPHF","TKR","TLGPY","TLK","TLKMF","TLN","TLPFF","TLPFY","TLPPF","TLSNF","TLSNY","TLTZY","TLX","TM","TMC","TMDX","TME","TMHC","TMICY","TMO","TMRAF","TMRAY","TMSNY","TMTNF","TMUS","TMXXF","TNABF","TNABY","TNCAF","TNET","TNEYF","TNK","TNL","TNRSF","TNXXF","TOEAF","TOELF","TOELY","TOITF","TOKUY","TOL","TOPPY","TORXF","TOST","TOTDY","TOWN","TOYOF","TPC","TPG","TPH","TPL","TPR","TPSRF","TPZEF","TR","TRATF","TRATY","TRAUF","TREX","TRGP","TRI","TRKNY","TRMB","TRMD","TRMK","TRMLF","TRN","TRNO","TROW","TRP","TRPCF","TRPPF","TRPRF","TRSBF","TRU","TRUMF","TRUMY","TRV","TRYIF","TRYIY","TS","TSCDF","TSCDY","TSCO","TSEM","TSGTF","TSGTY","TSLA","TSM","TSN","TSPCF","TSRYF","TSRYY","TSUKY","TSYHF","TSYHY","TT","TTAM","TTAN","TTBXF","TTC","TTCIF","TTD","TTDKF","TTDKY","TTE","TTEK","TTFNF","TTMI","TTNDF","TTNDY","TTRAF","TTUUF","TTVSY","TTWO","TU","TUIFF","TVAVF","TVTX","TW","TWLO","TWODF","TWODY","TX","TXHPF","TXN","TXNM","TXRH","TXT","TYCMY","TYEKF","TYHOY","TYIDY","TYL","TYNPF","TYOYF","TYOYY","TYTMF","U","UAL","UBER","UBS","UBSI","UBTRF","UCB","UCBJF","UCBJY","UDIRY","UDR","UE","UEC","UFGSY","UFPI","UGI","UGP","UHAL","UHAL.B","UHS","UI","UL","ULS","ULTA","UMBF","UMBFO","UMC","UMGNF","UMICF","UMICY","UNBLF","UNCFF","UNCHF","UNCRY","UNF","UNFI","UNH","UNICY","UNIXY","UNLRY","UNLYF","UNM","UNMA","UNP","UNPA","UNVGY","UOLGF","UOLGY","UOVEF","UOVEY","UPCHY","UPMKF","UPMMY","UPS","UPST","UPWK","URBN","URI","USAC","USAR","USB","USFD","USLM","USSJY","UTF","UTG","UTGPF","UTHR","UUGRY","UUGWF","UUUU","UWMC","UZD","UZE","UZF","V","VACNY","VAL","VALE","VARRY","VBREY","VC","VCISF","VCISY","VCTR","VCYT","VDMCY","VEEV","VEMLY","VEOEF","VEOEY","VEON","VERX","VESTF","VFC","VFS","VG","VIA","VIAAY","VIAV","VICI","VICR","VIK","VIPS","VIRT","VIST","VIV","VIVHY","VKTX","VLEEF","VLEEY","VLKAF","VLKPF","VLO","VLOUF","VLOWY","VLPNY","VLTO","VLVCY","VLVLY","VLVOF","VLY","VLYPN","VLYPO","VLYPP","VMC","VMI","VNET","VNNVF","VNO","VNOM","VNORP","VNRFY","VNT","VOD","VODPF","VOLAF","VOLVF","VONOY","VOPKY","VOYA","VOYJF","VRDN","VRNS","VRRM","VRSK","VRSN","VRT","VRTX","VSAT","VSCO","VSEC","VST","VTAGY","VTMX","VTR","VTRS","VTTGF","VVV","VVVNF","VWAGY","VWAPY","VWDRY","VWSYF","VZ","W","WAB","WAFD","WAFDP","WAL","WARFF","WARFY","WAT","WAWIF","WAY","WB","WBD","WBRBY","WBS","WCC","WCHNF","WCN","WCPRF","WD","WDAY","WDC","WDFC","WDOFF","WDPSF","WDS","WEBNF","WEC","WEGRY","WEGZY","WEICF","WEIGF","WELL","WES","WEX","WF","WFAFF","WFAFY","WFC","WFG","WFRD","WGS","WGXRF","WH","WHD","WHGLY","WHGRF","WHITF","WHR","WIGBY","WILLF","WILWY","WILYY","WING","WIT","WIX","WIZEY","WJRYF","WJRYY","WK","WKCMF","WLK","WLMIF","WLMIY","WLWHY","WM","WMB","WMG","WMMVF","WMMVY","WMS","WMT","WNDLF","WNGRF","WOLTF","WOLWF","WOPEF","WOR","WPC","WPLCF","WPM","WPP","WPPGF","WRB","WRBY","WRD","WRFRF","WRTBF","WRTBY","WSBC","WSBCO","WSC","WSFS","WSM","WSO","WSO.B","WSPOF","WST","WTBDY","WTCHF","WTFC","WTFCN","WTKWY","WTM","WTRG","WTS","WTW","WU","WULF","WUXAY","WUXIF","WWD","WXIBF","WXXWY","WY","WYGPF","WYGPY","WYNMF","WYNMY","WYNN","XEL","XELLL","XENE","XIACF","XIACY","XISHY","XJNGF","XMTR","XNGSY","XNYIF","XOM","XP","XPEV","XPNGF","XPO","XRAY","XROLF","XTEPY","XYIGY","XYL","XYZ","XZJCF","YACAF","YAHOF","YAHOY","YAMCY","YAMHF","YARIY","YASKY","YATRF","YATRY","YETI","YKLTF","YKLTY","YMHAY","YMM","YOKEF","YOKEY","YONXF","YOU","YPF","YRAIF","YSHLF","YUEIY","YUM","YUMC","YZCAY","Z","ZBH","ZBRA","ZEGLF","ZETA","ZFSVF","ZG","ZGN","ZHEXF","ZIJMF","ZIJMY","ZIM","ZION","ZIONP","ZIZTF","ZJLMF","ZK","ZLAB","ZLDPF","ZLDPY","ZLIOY","ZLNDY","ZM","ZNKKY","ZONNF","ZS","ZSHGY","ZTCOF","ZTO","ZTS","ZURVY","ZWS"]

def safe_get(df, key):
    """Dataframe içinde veri varsa getirir, yoksa boş liste döner"""
    try:
        if key in df.index:
            return df.loc[key].fillna(0).tolist()
        return [0] * len(df.columns)
    except:
        return []

print(f"Toplam {len(tickers)} hisse için veri çekiliyor...")

summary_list = []

for ticker in tickers:
    print(f"İşleniyor: {ticker}")
    try:
        stock = yf.Ticker(ticker)
        
        # Çeyreklik verileri al
        bs = stock.quarterly_balance_sheet
        inc = stock.quarterly_financials
        cf = stock.quarterly_cashflow
        
        # Ortak tarihler (En güncelden eskiye)
        # Gelir tablosundaki tarihleri referans alıyoruz
        if inc.empty:
            print(f"{ticker} verisi boş, geçiliyor.")
            continue
            
        dates = [d.strftime('%Y-%m-%d') for d in inc.columns]
        
        # Verileri sözlük yapısına çevir
# --- DÜZELTME BAŞLANGICI ---
        # Net Kar için önce "Common Stockholders"a bak, yoksa düz "Net Income"a bak
        net_income_row = []
        if "Net Income Common Stockholders" in inc.index:
             net_income_row = safe_get(inc, "Net Income Common Stockholders")
        elif "Net Income" in inc.index:
             net_income_row = safe_get(inc, "Net Income")
        
        # Aynı mantık Toplam Borç için de geçerli
        total_debt_row = []
        if "Total Debt" in bs.index:
            total_debt_row = safe_get(bs, "Total Debt")
        else:
            # Eğer Total Debt yoksa (Kısa + Uzun Borç) topla
            short_term = safe_get(bs, "Current Debt") if "Current Debt" in bs.index else safe_get(bs, "Current Liabilities") # Basit bir fallback
            long_term = safe_get(bs, "Long Term Debt")
            # Liste elemanlarını topla (Basit yöntem)
            # Not: Bu detaylı hesaplama gerektirir ama şimdilik "Net Debt" verisine güveneceğiz.
        
        data = {
            "ticker": ticker,
            "dates": dates,
            "financials": {
                # Gelir Tablosu
                "Total Revenue": safe_get(inc, "Total Revenue"),
                "Gross Profit": safe_get(inc, "Gross Profit"),
                
                # --- DÜZELTİLEN SATIR ---
                "Net Income": net_income_row, 
                # ------------------------
                
                "EBITDA": safe_get(inc, "EBITDA"),
                "Operating Income": safe_get(inc, "Operating Income"),
                "Cost Of Revenue": safe_get(inc, "Cost Of Revenue"),
                
                # Bilanço
                "Total Assets": safe_get(bs, "Total Assets"),
                "Total Current Assets": safe_get(bs, "Total Current Assets") if "Total Current Assets" in bs.index else safe_get(bs, "Current Assets"),
                "Total Liab": safe_get(bs, "Total Liabilities Net Minority Interest"),
                "Total Current Liab": safe_get(bs, "Total Liabilities Net Minority Interest") if "Total Liabilities Net Minority Interest" in bs.index else safe_get(bs, "Current Liabilities"),
                "Total Stockholder Equity": safe_get(bs, "Stockholders Equity"),
                "Cash And Cash Equivalents": safe_get(bs, "Cash And Cash Equivalents"),
                "Inventory": safe_get(bs, "Inventory"),
                "Net Debt": safe_get(bs, "Net Debt"),
                
                # Nakit Akış
                "Operating Cash Flow": safe_get(cf, "Operating Cash Flow"),
                "Capital Expenditure": safe_get(cf, "Capital Expenditure"),
                "Free Cash Flow": safe_get(cf, "Free Cash Flow")
            }
        }
        # --- DÜZELTME SONU ---
        
        # JSON Olarak Kaydet
        file_path = os.path.join(DATA_FOLDER, f"{ticker}.json")
        with open(file_path, 'w', encoding='utf-8') as f:
            json.dump(data, f, ensure_ascii=False)
            
        summary_list.append(ticker)

    except Exception as e:
        print(f"Hata ({ticker}): {e}")

# Listeyi de kaydet (HTML dropdown için)
with open(os.path.join(DATA_FOLDER, "tickers_list.json"), 'w') as f:
    json.dump(summary_list, f)

print("Tüm işlemler tamamlandı! HTML dosyasını açabilirsin.")